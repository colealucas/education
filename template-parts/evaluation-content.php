<?php
/**
 *  Evaluation Content
 */

?>

<!-- Evaluation Steps Modals -->
<?php if ( have_rows('evaluation_steps') ) : $step_count = 0; ?>
    <?php while ( have_rows('evaluation_steps') ) : the_row(); 
        $step_title = get_sub_field('step_title');
        $step_count++;

        $prev_modal_id = '#evaluation-modal-' . ($step_count - 1);
        $next_modal_id = '#evaluation-modal-' . ($step_count + 1);
    ?>

        <div style="display: none;" id="evaluation-modal-<?php echo $step_count; ?>" class="w-[833px] p-24px rounded-24px">
            <div class="phase-bar flex items-center justify-between gap-12px mt-30px p-16px py-20px rounded-16px text-primary text-24px font-500 leading-120">
                <div class="flex gap-12px items-center">
                    <span class="step-icon flex items-center justify-center size-[74px] rounded-50 bg-primary-medium">
                        <svg fill="currentColor" height="36px" width="36px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve" stroke="currentColor"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M492.792,198.395c-10.526-7.617-28.507-5.241-56.59,7.478c-7.058,3.197-13.756,6.602-19.355,9.598V105.235 c0-5.633-4.566-10.199-10.199-10.199H296.59c2.982-5.575,6.362-12.229,9.536-19.238c12.719-28.084,15.095-46.066,7.478-56.59 C300.704,1.385,266.252,0,256,0s-44.704,1.385-57.605,19.209c-7.617,10.525-5.24,28.507,7.478,56.59 c3.175,7.009,6.554,13.662,9.536,19.238H105.352c-5.633,0-10.199,4.566-10.199,10.199v110.35 c-5.617-3.023-12.363-6.471-19.479-9.707c-27.993-12.728-45.936-15.106-56.465-7.484C1.385,211.296,0,245.748,0,256 s1.385,44.704,19.208,57.604c10.532,7.622,28.473,5.243,56.466-7.484c7.115-3.235,13.863-6.684,19.479-9.707v110.628 c0,5.633,4.566,10.199,10.199,10.199h110.023c-2.972,5.537-6.336,12.136-9.495,19.086c-12.728,27.993-15.105,45.935-7.484,56.466 C211.296,510.615,245.748,512,256,512s44.704-1.385,57.604-19.209c7.621-10.531,5.243-28.473-7.484-56.466 c-3.161-6.95-6.523-13.549-9.495-19.086h110.023c5.633,0,10.199-4.566,10.199-10.199V296.528 c5.599,2.998,12.297,6.402,19.355,9.599c28.083,12.719,46.066,15.096,56.59,7.478C510.615,300.704,512,266.252,512,256 S510.615,211.296,492.792,198.395z M480.848,297.069c-0.066,0.04-7.265,3.653-36.621-9.703 c-16.902-7.69-31.991-16.881-32.14-16.971c-3.279-2.005-7.407-1.998-10.678,0.02l-0.1,0.061c-3.02,1.855-4.861,5.146-4.861,8.691 v117.674H279.095c-3.693,0-7.097,1.998-8.9,5.22s-1.723,7.169,0.209,10.317c0.092,0.15,9.286,15.179,16.977,32.018 c13.344,29.219,9.729,36.386,9.698,36.436c-3.779,5.221-19.46,10.769-41.079,10.769s-37.301-5.548-41.069-10.755 c-0.04-0.064-3.654-7.23,9.689-36.449c7.69-16.839,16.885-31.868,16.976-32.017c1.933-3.147,2.014-7.094,0.211-10.318 c-1.803-3.224-5.208-5.221-8.902-5.221H115.553V279.336c0-3.571-1.869-6.882-4.925-8.729l-0.308-0.188 c-3.276-2.025-7.414-2.029-10.697-0.014c-0.15,0.092-15.179,9.286-32.018,16.977c-29.22,13.343-36.387,9.728-36.436,9.697 c-5.222-3.778-10.77-19.459-10.77-41.078s5.548-37.301,10.756-41.072c0.065-0.04,7.23-3.654,36.449,9.689 c16.839,7.69,31.868,16.885,32.017,16.976c3.279,2.014,7.418,2.009,10.694-0.01l0.312-0.19c3.057-1.847,4.925-5.159,4.925-8.729 v-117.23h117.352c3.691,0,7.093-1.993,8.897-5.212c1.804-3.218,1.73-7.161-0.196-10.308c-0.091-0.149-9.201-15.093-16.9-31.983 c-13.441-29.485-9.814-36.713-9.784-36.763c3.779-5.221,19.46-10.769,41.079-10.769s37.301,5.548,41.069,10.756 c0.04,0.064,3.654,7.265-9.703,36.621c-7.69,16.902-16.881,31.991-16.971,32.14c-1.926,3.147-2.001,7.089-0.196,10.308 c1.804,3.219,5.207,5.212,8.897,5.212h117.352v117.396c0,3.545,1.841,6.836,4.861,8.691l0.1,0.061 c3.271,2.017,7.399,2.025,10.677,0.02c0.149-0.091,15.093-9.201,31.983-16.9c29.218-13.32,36.581-9.878,36.774-9.775 c5.217,3.794,10.758,19.468,10.758,41.071C491.602,277.619,486.053,293.301,480.848,297.069z"></path> </g> </g> <g> <g> <path d="M375.331,317.195c-5.633,0-10.199,4.566-10.199,10.199v48.956c0,5.633,4.566,10.199,10.199,10.199 s10.199-4.566,10.199-10.199v-48.956C385.53,321.761,380.964,317.195,375.331,317.195z"></path> </g> </g> <g> <g> <path d="M375.331,285.578c-5.633,0-10.199,4.566-10.199,10.199v2.04c0,5.633,4.566,10.199,10.199,10.199 s10.199-4.566,10.199-10.199v-2.04C385.53,290.144,380.964,285.578,375.331,285.578z"></path> </g> </g> </g></svg>
                    </span>
                    <?php echo $step_title; ?>
                </div>

                <div>
                    <a href="<?php the_permalink( get_the_ID() ) ?>?print=true&step=1" class="inline-block cursor-pointer print-button" target="_blank">
                        <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect width="40" height="40" rx="20" fill="var(--primary-color)"/>
                            <path d="M14 17V10H26V17M14 26H12C11.4696 26 10.9609 25.7893 10.5858 25.4142C10.2107 25.0391 10 24.5304 10 24V19C10 18.4696 10.2107 17.9609 10.5858 17.5858C10.9609 17.2107 11.4696 17 12 17H28C28.5304 17 29.0391 17.2107 29.4142 17.5858C29.7893 17.9609 30 18.4696 30 19V24C30 24.5304 29.7893 25.0391 29.4142 25.4142C29.0391 25.7893 28.5304 26 28 26H26M14 22H26V30H14V22Z" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </a>
                </div>
            </div>

            <div class="relative">
                <?php if( have_rows('evaluation_content') ): ?>
                    <?php while ( have_rows('evaluation_content') ) : the_row(); ?>

                        <?php get_template_part('template-parts/flexible-content/evaluation' , 'content'); // get flexible content sections ?>
                    
                    <?php endwhile; ?>
                <?php endif; ?>
            </div>

            <div class="mt-12px pagination-wrapper bg-light-gray rounded-16px">
                <a href="#" class="theme-pagination-btn tp-button-left <?php echo ($step_count <= 1) ? 'hide' : ''; ?>" data-fancybox data-src="<?php echo $prev_modal_id; ?>">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="15" viewBox="0 0 14 15" fill="none">
                        <path d="M12.8334 7.50002H1.16669M1.16669 7.50002L7.00002 13.3334M1.16669 7.50002L7.00002 1.66669" stroke="currentColor" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"></path>
                    </svg>
                    <?php echo $get_static_text[get_lang()]['pagination_back']; ?>
                </a>

                <a href="#" class="theme-pagination-btn tp-button-right <?php echo ($step_count >= count(get_field('evaluation_steps'))) ? 'hide' : ''; ?>" data-fancybox data-src="<?php echo $next_modal_id; ?>">
                    <?php echo $get_static_text[get_lang()]['pagination_next']; ?>

                    <svg class="rotate180" xmlns="http://www.w3.org/2000/svg" width="14" height="15" viewBox="0 0 14 15" fill="none">
                        <path d="M12.8334 7.50002H1.16669M1.16669 7.50002L7.00002 13.3334M1.16669 7.50002L7.00002 1.66669" stroke="currentColor" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"></path>
                    </svg>
                </a>
            </div>
        </div>

<?php endwhile; endif; ?>
<!-- End Evaluation Steps Modals -->

<div class="section py-32px theme-steps">
    <div class="container">
        <div class="parts flex flex-wrap gap-20px">

        <?php if ( have_rows('evaluation_steps') ) : $step_count = 0; ?>
            <?php while ( have_rows('evaluation_steps') ) : the_row(); 
                $step_title = get_sub_field('step_title');
                $step_count++;
            ?>

            <!-- Step n -->
            <div class="w-full md:w-[calc(50%-20px)] lg:w-[calc(25%-20px)] part-col">
                <a href="javascript:;" data-fancybox data-src="#evaluation-modal-<?php echo $step_count; ?>" class="step-box text-primary hover:text-primary-dark text-primary hover:text-primary-dark flex flex-col gap-20px justify-between bg-primary-light p-32px rounded-24px min-h-[300px]">
                    <span class="step-icon flex items-center justify-center size-[74px] rounded-50 bg-primary-medium">
                        <svg fill="currentColor" height="40px" width="40px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve" stroke="currentColor"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M492.792,198.395c-10.526-7.617-28.507-5.241-56.59,7.478c-7.058,3.197-13.756,6.602-19.355,9.598V105.235 c0-5.633-4.566-10.199-10.199-10.199H296.59c2.982-5.575,6.362-12.229,9.536-19.238c12.719-28.084,15.095-46.066,7.478-56.59 C300.704,1.385,266.252,0,256,0s-44.704,1.385-57.605,19.209c-7.617,10.525-5.24,28.507,7.478,56.59 c3.175,7.009,6.554,13.662,9.536,19.238H105.352c-5.633,0-10.199,4.566-10.199,10.199v110.35 c-5.617-3.023-12.363-6.471-19.479-9.707c-27.993-12.728-45.936-15.106-56.465-7.484C1.385,211.296,0,245.748,0,256 s1.385,44.704,19.208,57.604c10.532,7.622,28.473,5.243,56.466-7.484c7.115-3.235,13.863-6.684,19.479-9.707v110.628 c0,5.633,4.566,10.199,10.199,10.199h110.023c-2.972,5.537-6.336,12.136-9.495,19.086c-12.728,27.993-15.105,45.935-7.484,56.466 C211.296,510.615,245.748,512,256,512s44.704-1.385,57.604-19.209c7.621-10.531,5.243-28.473-7.484-56.466 c-3.161-6.95-6.523-13.549-9.495-19.086h110.023c5.633,0,10.199-4.566,10.199-10.199V296.528 c5.599,2.998,12.297,6.402,19.355,9.599c28.083,12.719,46.066,15.096,56.59,7.478C510.615,300.704,512,266.252,512,256 S510.615,211.296,492.792,198.395z M480.848,297.069c-0.066,0.04-7.265,3.653-36.621-9.703 c-16.902-7.69-31.991-16.881-32.14-16.971c-3.279-2.005-7.407-1.998-10.678,0.02l-0.1,0.061c-3.02,1.855-4.861,5.146-4.861,8.691 v117.674H279.095c-3.693,0-7.097,1.998-8.9,5.22s-1.723,7.169,0.209,10.317c0.092,0.15,9.286,15.179,16.977,32.018 c13.344,29.219,9.729,36.386,9.698,36.436c-3.779,5.221-19.46,10.769-41.079,10.769s-37.301-5.548-41.069-10.755 c-0.04-0.064-3.654-7.23,9.689-36.449c7.69-16.839,16.885-31.868,16.976-32.017c1.933-3.147,2.014-7.094,0.211-10.318 c-1.803-3.224-5.208-5.221-8.902-5.221H115.553V279.336c0-3.571-1.869-6.882-4.925-8.729l-0.308-0.188 c-3.276-2.025-7.414-2.029-10.697-0.014c-0.15,0.092-15.179,9.286-32.018,16.977c-29.22,13.343-36.387,9.728-36.436,9.697 c-5.222-3.778-10.77-19.459-10.77-41.078s5.548-37.301,10.756-41.072c0.065-0.04,7.23-3.654,36.449,9.689 c16.839,7.69,31.868,16.885,32.017,16.976c3.279,2.014,7.418,2.009,10.694-0.01l0.312-0.19c3.057-1.847,4.925-5.159,4.925-8.729 v-117.23h117.352c3.691,0,7.093-1.993,8.897-5.212c1.804-3.218,1.73-7.161-0.196-10.308c-0.091-0.149-9.201-15.093-16.9-31.983 c-13.441-29.485-9.814-36.713-9.784-36.763c3.779-5.221,19.46-10.769,41.079-10.769s37.301,5.548,41.069,10.756 c0.04,0.064,3.654,7.265-9.703,36.621c-7.69,16.902-16.881,31.991-16.971,32.14c-1.926,3.147-2.001,7.089-0.196,10.308 c1.804,3.219,5.207,5.212,8.897,5.212h117.352v117.396c0,3.545,1.841,6.836,4.861,8.691l0.1,0.061 c3.271,2.017,7.399,2.025,10.677,0.02c0.149-0.091,15.093-9.201,31.983-16.9c29.218-13.32,36.581-9.878,36.774-9.775 c5.217,3.794,10.758,19.468,10.758,41.071C491.602,277.619,486.053,293.301,480.848,297.069z"></path> </g> </g> <g> <g> <path d="M375.331,317.195c-5.633,0-10.199,4.566-10.199,10.199v48.956c0,5.633,4.566,10.199,10.199,10.199 s10.199-4.566,10.199-10.199v-48.956C385.53,321.761,380.964,317.195,375.331,317.195z"></path> </g> </g> <g> <g> <path d="M375.331,285.578c-5.633,0-10.199,4.566-10.199,10.199v2.04c0,5.633,4.566,10.199,10.199,10.199 s10.199-4.566,10.199-10.199v-2.04C385.53,290.144,380.964,285.578,375.331,285.578z"></path> </g> </g> </g></svg>
                    </span>

                    <h3 class="text-28px font-500 text-primary leading-120"><?php echo $step_title; ?></h3>
                </a>
            </div>

            <?php endwhile; endif; ?>
        </div>
    </div>
</div>